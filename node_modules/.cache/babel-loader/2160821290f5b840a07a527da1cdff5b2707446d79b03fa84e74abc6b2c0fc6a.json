{"ast":null,"code":"var _jsxFileName = \"D:\\\\server\\\\poll-editor\\\\src\\\\components\\\\LexicalEditor.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useMemo } from 'react';\nimport { LexicalComposer } from '@lexical/react/LexicalComposer';\nimport { RichTextPlugin } from '@lexical/react/LexicalRichTextPlugin';\nimport { ContentEditable } from '@lexical/react/LexicalContentEditable';\nimport { HistoryPlugin } from '@lexical/react/LexicalHistoryPlugin';\nimport { OnChangePlugin } from '@lexical/react/LexicalOnChangePlugin';\nimport { useLexicalComposerContext } from '@lexical/react/LexicalComposerContext';\nimport { $getRoot, $getSelection, FORMAT_TEXT_COMMAND } from 'lexical';\nimport './LexicalEditor.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction ToolbarPlugin() {\n  _s();\n  const [editor] = useLexicalComposerContext();\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"lexical-toolbar\",\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      onClick: () => editor.dispatchCommand(FORMAT_TEXT_COMMAND, 'bold'),\n      className: \"toolbar-btn\",\n      title: \"Bold\",\n      children: /*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"B\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 15,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      onClick: () => editor.dispatchCommand(FORMAT_TEXT_COMMAND, 'italic'),\n      className: \"toolbar-btn\",\n      title: \"Italic\",\n      children: /*#__PURE__*/_jsxDEV(\"em\", {\n        children: \"I\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 29,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 23,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      onClick: () => editor.dispatchCommand(FORMAT_TEXT_COMMAND, 'underline'),\n      className: \"toolbar-btn\",\n      title: \"Underline\",\n      children: /*#__PURE__*/_jsxDEV(\"u\", {\n        children: \"U\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 37,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 31,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 14,\n    columnNumber: 5\n  }, this);\n}\n\n// naive HTML serialization for paragraphs and text nodes\n_s(ToolbarPlugin, \"MUJTZ3t3NKyXWeKoJUbyWHO70Z4=\", false, function () {\n  return [useLexicalComposerContext];\n});\n_c = ToolbarPlugin;\nfunction editorStateToHtml(editorState) {\n  let html = '';\n  editorState.read(() => {\n    const root = $getRoot();\n    const children = root.getChildren();\n    html = children.map(node => {\n      if (typeof node.getTextContent === 'function') {\n        const text = node.getTextContent();\n        return `<p>${text.replace(/&/g, '&amp;').replace(/</g, '&lt;')}</p>`;\n      }\n      return '';\n    }).join('');\n  });\n  return html;\n}\nfunction editorStateToPlainText(editorState) {\n  let text = '';\n  editorState.read(() => {\n    const selection = $getSelection();\n    const root = $getRoot();\n    text = root.getTextContent();\n  });\n  return text;\n}\nconst LexicalEditor = ({\n  initialValue,\n  onChange,\n  placeholder\n}) => {\n  _s2();\n  const initialConfig = useMemo(() => ({\n    namespace: 'PollEditor',\n    theme: {\n      paragraph: 'lexical-paragraph',\n      text: {\n        bold: 'lexical-text-bold',\n        italic: 'lexical-text-italic',\n        underline: 'lexical-text-underline'\n      }\n    },\n    editorState: initialValue || undefined,\n    onError: error => {\n      console.error('Lexical error:', error);\n    }\n  }), [initialValue]);\n  const handleChange = editorState => {\n    if (!onChange) return;\n    const plain = editorStateToPlainText(editorState);\n    const html = editorStateToHtml(editorState);\n    onChange({\n      plain,\n      html\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"lexical-editor-wrapper\",\n    children: /*#__PURE__*/_jsxDEV(LexicalComposer, {\n      initialConfig: initialConfig,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lexical-editor\",\n        children: [/*#__PURE__*/_jsxDEV(ToolbarPlugin, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(RichTextPlugin, {\n          contentEditable: /*#__PURE__*/_jsxDEV(ContentEditable, {\n            className: \"lexical-content-editable\",\n            placeholder: placeholder\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 30\n          }, this),\n          placeholder: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lexical-placeholder\",\n            children: placeholder\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 26\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(OnChangePlugin, {\n          onChange: handleChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(HistoryPlugin, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 97,\n    columnNumber: 5\n  }, this);\n};\n_s2(LexicalEditor, \"gkUJq0Zg+mhNhroeL8dx2bO7M/M=\");\n_c2 = LexicalEditor;\nexport default LexicalEditor;\nvar _c, _c2;\n$RefreshReg$(_c, \"ToolbarPlugin\");\n$RefreshReg$(_c2, \"LexicalEditor\");","map":{"version":3,"names":["React","useMemo","LexicalComposer","RichTextPlugin","ContentEditable","HistoryPlugin","OnChangePlugin","useLexicalComposerContext","$getRoot","$getSelection","FORMAT_TEXT_COMMAND","jsxDEV","_jsxDEV","ToolbarPlugin","_s","editor","className","children","type","onClick","dispatchCommand","title","fileName","_jsxFileName","lineNumber","columnNumber","_c","editorStateToHtml","editorState","html","read","root","getChildren","map","node","getTextContent","text","replace","join","editorStateToPlainText","selection","LexicalEditor","initialValue","onChange","placeholder","_s2","initialConfig","namespace","theme","paragraph","bold","italic","underline","undefined","onError","error","console","handleChange","plain","contentEditable","_c2","$RefreshReg$"],"sources":["D:/server/poll-editor/src/components/LexicalEditor.jsx"],"sourcesContent":["import React, { useMemo } from 'react';\r\nimport { LexicalComposer } from '@lexical/react/LexicalComposer';\r\nimport { RichTextPlugin } from '@lexical/react/LexicalRichTextPlugin';\r\nimport { ContentEditable } from '@lexical/react/LexicalContentEditable';\r\nimport { HistoryPlugin } from '@lexical/react/LexicalHistoryPlugin';\r\nimport { OnChangePlugin } from '@lexical/react/LexicalOnChangePlugin';\r\nimport { useLexicalComposerContext } from '@lexical/react/LexicalComposerContext';\r\nimport { $getRoot, $getSelection, FORMAT_TEXT_COMMAND } from 'lexical';\r\nimport './LexicalEditor.css';\r\n\r\nfunction ToolbarPlugin() {\r\n  const [editor] = useLexicalComposerContext();\r\n  return (\r\n    <div className=\"lexical-toolbar\">\r\n      <button\r\n        type=\"button\"\r\n        onClick={() => editor.dispatchCommand(FORMAT_TEXT_COMMAND, 'bold')}\r\n        className=\"toolbar-btn\"\r\n        title=\"Bold\"\r\n      >\r\n        <strong>B</strong>\r\n      </button>\r\n      <button\r\n        type=\"button\"\r\n        onClick={() => editor.dispatchCommand(FORMAT_TEXT_COMMAND, 'italic')}\r\n        className=\"toolbar-btn\"\r\n        title=\"Italic\"\r\n      >\r\n        <em>I</em>\r\n      </button>\r\n      <button\r\n        type=\"button\"\r\n        onClick={() => editor.dispatchCommand(FORMAT_TEXT_COMMAND, 'underline')}\r\n        className=\"toolbar-btn\"\r\n        title=\"Underline\"\r\n      >\r\n        <u>U</u>\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n\r\n// naive HTML serialization for paragraphs and text nodes\r\nfunction editorStateToHtml(editorState) {\r\n  let html = '';\r\n  editorState.read(() => {\r\n    const root = $getRoot();\r\n    const children = root.getChildren();\r\n    html = children\r\n      .map((node) => {\r\n        if (typeof node.getTextContent === 'function') {\r\n          const text = node.getTextContent();\r\n          return `<p>${text.replace(/&/g, '&amp;').replace(/</g, '&lt;')}</p>`;\r\n        }\r\n        return '';\r\n      })\r\n      .join('');\r\n  });\r\n  return html;\r\n}\r\n\r\nfunction editorStateToPlainText(editorState) {\r\n  let text = '';\r\n  editorState.read(() => {\r\n    const selection = $getSelection();\r\n    const root = $getRoot();\r\n    text = root.getTextContent();\r\n  });\r\n  return text;\r\n}\r\n\r\nconst LexicalEditor = ({ initialValue, onChange, placeholder }) => {\r\n  const initialConfig = useMemo(() => ({\r\n    namespace: 'PollEditor',\r\n    theme: {\r\n      paragraph: 'lexical-paragraph',\r\n      text: {\r\n        bold: 'lexical-text-bold',\r\n        italic: 'lexical-text-italic',\r\n        underline: 'lexical-text-underline',\r\n      },\r\n    },\r\n    editorState: initialValue || undefined,\r\n    onError: (error) => {\r\n      console.error('Lexical error:', error);\r\n    },\r\n  }), [initialValue]);\r\n\r\n  const handleChange = (editorState) => {\r\n    if (!onChange) return;\r\n    const plain = editorStateToPlainText(editorState);\r\n    const html = editorStateToHtml(editorState);\r\n    onChange({ plain, html });\r\n  };\r\n\r\n  return (\r\n    <div className=\"lexical-editor-wrapper\">\r\n      <LexicalComposer initialConfig={initialConfig}>\r\n        <div className=\"lexical-editor\">\r\n          <ToolbarPlugin />\r\n          <RichTextPlugin\r\n            contentEditable={<ContentEditable className=\"lexical-content-editable\" placeholder={placeholder} />}\r\n            placeholder={<div className=\"lexical-placeholder\">{placeholder}</div>}\r\n          />\r\n          <OnChangePlugin onChange={handleChange} />\r\n          <HistoryPlugin />\r\n        </div>\r\n      </LexicalComposer>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LexicalEditor;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}